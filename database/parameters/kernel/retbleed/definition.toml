# This is a libKCmdline definition document.

title = "retbleed - definition.toml"
name = "retbleed"
processor = "kernel"
description = '''Control mitigation of RETBleed (Arbitrary
Speculative Code Execution with Return Instructions)
vulnerability.

AMD-based UNRET and IBPB mitigations alone do not stop
sibling threads from influencing the predictions of other
sibling threads. For that reason, STIBP is used on pro-
cessors that support it, and mitigate SMT on processors
that don't.

off          - no mitigation
auto         - automatically select a migitation
auto,nosmt   - automatically select a mitigation,
disabling SMT if necessary for
the full mitigation (only on Zen1
and older without STIBP).
ibpb         - On AMD, mitigate short speculation
windows on basic block boundaries too.
Safe, highest perf impact. It also
enables STIBP if present. Not suitable
on Intel.
ibpb,nosmt   - Like "ibpb" above but will disable SMT
when STIBP is not available. This is
the alternative for systems which do not
have STIBP.
unret        - Force enable untrained return thunks,
only effective on AMD f15h-f17h based
systems.
unret,nosmt  - Like unret, but will disable SMT when STIBP
is not available. This is the alternative for
systems which do not have STIBP.

Selecting 'auto' will choose a mitigation method at run
time according to the CPU.

Not specifying this option is equivalent to retbleed=auto.
'''

[syntax]
type = "flag"
format = "flag"
choices = []
allow_empty = true
